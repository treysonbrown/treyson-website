[variables]
NIXPACKS_NO_CACHE = "1"

[phases.setup]
nixPkgs = ["nodejs_22"]

[phases.install]
# Use npm (ships with Node.js) so no corepack/pnpm setup is needed.
# --include=dev ensures vite + build tooling are installed even if NODE_ENV=production.
cmds = ["npm ci --include=dev"]

[phases.build]
cmds = ["NODE_ENV=production npm run build"]

[start]
cmd = "npm run start"
